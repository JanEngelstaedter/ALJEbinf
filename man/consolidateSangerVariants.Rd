% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SangerVariants.R
\name{consolidateSangerVariants}
\alias{consolidateSangerVariants}
\title{Consolidate variants called across Sanger sequences of the same sample}
\usage{
consolidateSangerVariants(variants, strictness = 3L)
}
\arguments{
\item{variants}{A list of called variant tables, as output by the \code{callSangerVatiants_fasta} function.}

\item{strictness}{Determines how stringent the consolidation across different sequences will be -
the greater this number the fewer variants will be called. See below for details.}
}
\value{
A list with the same structure as the input, containing two tables:
"summary" contains the number of variants of different types detected for each sample,
whereas "details" provides detailed information for each variant.
}
\description{
This function operates on output generated by the \code{callSangerVatiants_fasta} function.
The output that \code{callSangerVatiants_fasta} contains variants for each Sanger sequence,
but for one sample there are often several sequences that may overlap, e.g.
when there are forward and reverse reads.
\code{consolidateSangerVariants} attempts to consolidate these variants across reads into
a single variant call, with adjustable level of strictness as to when a variant is considered
"trustworthy".
}
\details{
The \code{strictness} parameter can take four different values that determines both which variants
will be retained and what the reported contig boundaries and length will be.
Depending on the value of \code{strictness}, the following variants will be reported:
\itemize{
  \item 0L: All
  \item 1L: Only those that are present in all reads that cover the respective position, i.e.
where there are no conflicts between variants detected vs. not detected.
  \item 2L: Only those that are present in all successful reads.
  \item 3L: Only those that are present in all reads (successul or not).
}
The following two examples illustrate these options. Both examples involve two reads,
but in the first both reads sequenced properly whereas in the second example one read
sequence was deemed unsuccessful:

Example 1: \cr
\cr
\code{-------x------y---------      Success=TRUE} \cr
\code{    ---x-----------------z--  Success=TRUE} \cr
\cr
\code{Strictness   Map_start   Map_end   Contig_length   Variants called} \cr
\code{0            1           28        28              x, y, z} \cr
\code{1            1           28        28              x, z} \cr
\code{2            5           24        20              x} \cr
\code{3            5           24        20              x} \cr
\cr
Example 2: \cr
\cr
\code{-------x------y---------  Success=TRUE}\cr
\code{   ---------------        Success=FALSE}\cr
\cr
\code{Strictness   Map_start   Map_end   Contig_length   Variants called} \cr
\code{0            1           24        24              x, y} \cr
\code{1            1           24        24              x, y} \cr
\code{2            1           24        24              x, y} \cr
\code{3            NA          NA        NA              none} \cr
}
